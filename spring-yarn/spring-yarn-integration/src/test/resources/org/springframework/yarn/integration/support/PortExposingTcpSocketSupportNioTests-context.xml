<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:int="https://www.springframework.org/schema/integration"
	xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"
	xmlns="https://www.springframework.org/schema/beans"
	xmlns:ip="https://www.springframework.org/schema/integration/ip"
	xmlns:yarn-int="https://www.springframework.org/schema/yarn/integration"
	xsi:schemaLocation="https://www.springframework.org/schema/beans
			https://www.springframework.org/schema/beans/spring-beans.xsd
			https://www.springframework.org/schema/yarn/integration
			https://www.springframework.org/schema/yarn/integration/spring-yarn-integration.xsd
			https://www.springframework.org/schema/integration
			https://www.springframework.org/schema/integration/spring-integration.xsd
			https://www.springframework.org/schema/integration/ip
			https://www.springframework.org/schema/integration/ip/spring-integration-ip.xsd">

	<bean id="tcpIpUtils" class="org.springframework.util.SocketUtils" />

	<bean id="socketSupport" class="org.springframework.yarn.integration.support.DefaultPortExposingTcpSocketSupport" />

	<ip:tcp-connection-factory id="serverConnectionFactory"
		type="server"
		using-nio="true"
		port="#{tcpIpUtils.findAvailableTcpPort(7400)}"
		socket-support="socketSupport"/>

	<ip:tcp-inbound-gateway id="inboundGateway"
		connection-factory="serverConnectionFactory"
		request-channel="serverChannel" />

	<int:channel id="serverChannel" />

	<bean id="mindAppmasterService" class="org.springframework.yarn.integration.ip.mind.TestService" >
		<property name="socketSupport" ref="socketSupport"/>
		<property name="messageChannel" ref="serverChannel"/>
	</bean>

</beans>
